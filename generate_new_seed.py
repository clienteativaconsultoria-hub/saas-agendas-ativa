
import datetime

data = """05/01 à 09/01	LUCAS	UNIMED ARARAS / ESSELENSE	PARTICULAR
12/01 à 16/01	LUCAS	UNIMED ARARAS / SC RIBEIRAO PRETO	PARTICULAR
19/01 à 23/01	LUCAS	UNIMED ARARAS / SC RIBEIRAO PRETO	PARTICULAR
26/01 à 30/01	LUCAS	UNIMED ARARAS / SC RIBEIRAO PRETO	PARTICULAR
02/02 à 06/02	LUCAS	VAGO	
09/02 à 13/02	LUCAS	VAGO	
16/02 à 20/02	LUCAS	VAGO	
23/02 à 27/02	LUCAS	VAGO	
02/03 à 06/03	LUCAS	VAGO	
09/03 à 13/03	LUCAS	VAGO	
16/03 à 20/03	LUCAS	VAGO	
23/03 à 27/03	LUCAS	VAGO	
30/03 à 03/04	LUCAS	VAGO	
06/04 à 10/04	LUCAS	VAGO	
13/04 à 17/04	LUCAS	VAGO	
20/04 à 24/04	LUCAS	VAGO	
27/04 à 01/05	LUCAS	VAGO	
04/05 à 08/05	LUCAS	VAGO	
11/05 à 15/05	LUCAS	VAGO	
18/05 à 22/05	LUCAS	VAGO	
25/05 à 29/05	LUCAS	VAGO	
01/06 à 05/06	LUCAS	VAGO	
08/06 à 12/06	LUCAS	VAGO	
15/06 à 19/06	LUCAS	VAGO	
22/06 à 26/06	LUCAS	VAGO	
29/06 à 03/07	LUCAS	VAGO	
06/07 à 10/07	LUCAS	VAGO	
13/07 à 17/07	LUCAS	VAGO	
20/07 à 24/07	LUCAS	VAGO	
27/07 à 31/07	LUCAS	VAGO	
03/08 à 07/08	LUCAS	VAGO	
10/08 à 14/08	LUCAS	VAGO	
17/08 à 21/08	LUCAS	VAGO	
24/08 à 28/08	LUCAS	VAGO	
31/08 à 04/09	LUCAS	VAGO	
07/09 à 11/09	LUCAS	VAGO	
14/09 à 18/09	LUCAS	VAGO	
21/09 à 25/09	LUCAS	VAGO	
28/09 à 02/10	LUCAS	VAGO	
05/10 à 09/10	LUCAS	VAGO	
12/10 à 16/10	LUCAS	VAGO	
19/10 à 23/10	LUCAS	VAGO	
26/10 à 30/10	LUCAS	VAGO	
02/11 à 06/11	LUCAS	VAGO	
09/11 à 13/11	LUCAS	VAGO	
16/11 à 20/11	LUCAS	VAGO	
23/11 à 27/11	LUCAS	VAGO	
30/11 à 04/12	LUCAS	VAGO	
07/12 à 11/12	LUCAS	VAGO	
14/12 à 18/12	LUCAS	VAGO	
21/12 à 25/12	LUCAS	VAGO	
05/01 à 09/01	ANDRÉ	THE ONE - BRASILIA	ROSE
12/01 à 16/01	ANDRÉ	THE ONE - BRASILIA	ROSE
19/01 à 23/01	ANDRÉ	ARARAS	PARTICULAR
26/01 à 30/01	ANDRÉ	ARARAS	PARTICULAR
02/02 à 06/02	ANDRÉ	SANTA SAUDE	NATALIA
09/02 à 13/02	ANDRÉ	CENTRO DE CEREBRO E COLUNA	ROSE
16/02 à 20/02	ANDRÉ	ARARAS	PARTICULAR
23/02 à 27/02	ANDRÉ	CENTRO DE CEREBRO E COLUNA	ROSE
02/03 à 06/03	ANDRÉ	CENTRO DE CEREBRO E COLUNA	ROSE
09/03 à 13/03	ANDRÉ	VAGO	
16/03 à 20/03	ANDRÉ	VAGO	
23/03 à 27/03	ANDRÉ	VAGO	
30/03 à 03/04	ANDRÉ	VAGO	
06/04 à 10/04	ANDRÉ	VAGO	
13/04 à 17/04	ANDRÉ	VAGO	
20/04 à 24/04	ANDRÉ	VAGO	
27/04 à 01/05	ANDRÉ	VAGO	
04/05 à 08/05	ANDRÉ	VAGO	
11/05 à 15/05	ANDRÉ	VAGO	
18/05 à 22/05	ANDRÉ	VAGO	
25/05 à 29/05	ANDRÉ	VAGO	
01/06 à 05/06	ANDRÉ	VAGO	
08/06 à 12/06	ANDRÉ	VAGO	
15/06 à 19/06	ANDRÉ	VAGO	
22/06 à 26/06	ANDRÉ	VAGO	
29/06 à 03/07	ANDRÉ	VAGO	
06/07 à 10/07	ANDRÉ	VAGO	
13/07 à 17/07	ANDRÉ	VAGO	
20/07 à 24/07	ANDRÉ	VAGO	
27/07 à 31/07	ANDRÉ	VAGO	
03/08 à 07/08	ANDRÉ	VAGO	
10/08 à 14/08	ANDRÉ	VAGO	
17/08 à 21/08	ANDRÉ	VAGO	
24/08 à 28/08	ANDRÉ	VAGO	
31/08 à 04/09	ANDRÉ	VAGO	
07/09 à 11/09	ANDRÉ	VAGO	
14/09 à 18/09	ANDRÉ	VAGO	
21/09 à 25/09	ANDRÉ	VAGO	
28/09 à 02/10	ANDRÉ	VAGO	
05/10 à 09/10	ANDRÉ	VAGO	
12/10 à 16/10	ANDRÉ	VAGO	
19/10 à 23/10	ANDRÉ	VAGO	
26/10 à 30/10	ANDRÉ	VAGO	
02/11 à 06/11	ANDRÉ	VAGO	
09/11 à 13/11	ANDRÉ	VAGO	
16/11 à 20/11	ANDRÉ	VAGO	
23/11 à 27/11	ANDRÉ	VAGO	
30/11 à 04/12	ANDRÉ	VAGO	
07/12 à 11/12	ANDRÉ	VAGO	
14/12 à 18/12	ANDRÉ	VAGO	
21/12 à 25/12	ANDRÉ	VAGO	
05/01 à 09/01	SIRLENE	SC MOGI DAS CRUZES	NATALIA
12/01 à 16/01	SIRLENE		CAROL
19/01 à 23/01	SIRLENE	SC SÃO CARLOS	CAROL
26/01 à 30/01	SIRLENE		ROSE
02/02 à 06/02	SIRLENE	VAGO	
09/02 à 13/02	SIRLENE	BARRETOS	CAROL
16/02 à 20/02	SIRLENE	BARRETOS	CAROL
23/02 à 27/02	SIRLENE	BARRETOS	CAROL
02/03 à 06/03	SIRLENE	BARRETOS	CAROL
09/03 à 13/03	SIRLENE	BARRETOS	CAROL
16/03 à 20/03	SIRLENE	JJM - GUARULHOS	JESUS
23/03 à 27/03	SIRLENE	BAURU	CAROL
30/03 à 03/04	SIRLENE		NATALIA
06/04 à 10/04	SIRLENE	JJM - GUARULHOS	JESUS
13/04 à 17/04	SIRLENE	BAURU	CAROL
20/04 à 24/04	SIRLENE	JJM - GUARULHOS	JESUS
27/04 à 01/05	SIRLENE	JJM - GUARULHOS	JESUS
04/05 à 08/05	SIRLENE	JJM - GUARULHOS	JESUS
11/05 à 15/05	SIRLENE	JJM - GUARULHOS	JESUS
18/05 à 22/05	SIRLENE	BAURU	CAROL
25/05 à 29/05	SIRLENE	BAURU	CAROL
01/06 à 05/06	SIRLENE	JJM - GUARULHOS	JESUS
08/06 à 12/06	SIRLENE	BAURU	CAROL
15/06 à 19/06	SIRLENE	BAURU	CAROL
22/06 à 26/06	SIRLENE	BAURU	CAROL
29/06 à 03/07	SIRLENE		NATALIA
06/07 à 10/07	SIRLENE	BAURU	CAROL
13/07 à 17/07	SIRLENE	BAURU	CAROL
20/07 à 24/07	SIRLENE	BAURU	CAROL
27/07 à 31/07	SIRLENE	BAURU	CAROL
03/08 à 07/08	SIRLENE		NATALIA
10/08 à 14/08	SIRLENE	BAURU	CAROL
17/08 à 21/08	SIRLENE	BAURU	CAROL
24/08 à 28/08	SIRLENE		NATALIA
31/08 à 04/09	SIRLENE		NATALIA
07/09 à 11/09	SIRLENE		NATALIA
14/09 à 18/09	SIRLENE		NATALIA
21/09 à 25/09	SIRLENE	BAURU	CAROL
28/09 à 02/10	SIRLENE	BAURU	CAROL
05/10 à 09/10	SIRLENE	VAGO	
12/10 à 16/10	SIRLENE	VAGO	
19/10 à 23/10	SIRLENE	VAGO	
26/10 à 30/10	SIRLENE	VAGO	
02/11 à 06/11	SIRLENE	VAGO	
09/11 à 13/11	SIRLENE	VAGO	
16/11 à 20/11	SIRLENE	VAGO	
23/11 à 27/11	SIRLENE	VAGO	
30/11 à 04/12	SIRLENE	VAGO	
07/12 à 11/12	SIRLENE	VAGO	
14/12 à 18/12	SIRLENE	VAGO	
21/12 à 25/12	SIRLENE	VAGO	
05/01 à 09/01	MAYARA	UNIPASA - RJ	JULIANA
12/01 à 16/01	MAYARA	SC MOGI DAS CRUZES	NATALIA
19/01 à 23/01	MAYARA	SC MOGI DAS CRUZES	NATALIA
26/01 à 30/01	MAYARA	UNIPASA - RJ	JULIANA
02/02 à 06/02	MAYARA	VAGO	
09/02 à 13/02	MAYARA	SANTA MARCELINA	NATALIA
16/02 à 20/02	MAYARA	SANTA MARCELINA	NATALIA
23/02 à 27/02	MAYARA	SC BRAGANÇA PAULISTA	ANDREIA
02/03 à 06/03	MAYARA	SANTA MARCELINA	NATALIA
09/03 à 13/03	MAYARA	VAGO	
16/03 à 20/03	MAYARA	VAGO	
23/03 à 27/03	MAYARA	VAGO	
30/03 à 03/04	MAYARA	SC BRAGANÇA PAULISTA	ANDREIA
06/04 à 10/04	MAYARA	VAGO	
13/04 à 17/04	MAYARA	VAGO	
20/04 à 24/04	MAYARA	VAGO	
27/04 à 01/05	MAYARA	VAGO	
04/05 à 08/05	MAYARA	VAGO	
11/05 à 15/05	MAYARA	VAGO	
18/05 à 22/05	MAYARA	VAGO	
25/05 à 29/05	MAYARA	VAGO	
01/06 à 05/06	MAYARA	VAGO	
08/06 à 12/06	MAYARA	VAGO	
15/06 à 19/06	MAYARA	VAGO	
22/06 à 26/06	MAYARA	VAGO	
29/06 à 03/07	MAYARA	SC BRAGANÇA PAULISTA	ANDREIA
06/07 à 10/07	MAYARA	VAGO	
13/07 à 17/07	MAYARA	VAGO	
20/07 à 24/07	MAYARA	VAGO	
27/07 à 31/07	MAYARA	VAGO	
03/08 à 07/08	MAYARA	SC BRAGANÇA PAULISTA	ANDREIA
10/08 à 14/08	MAYARA	VAGO	
17/08 à 21/08	MAYARA	VAGO	
24/08 à 28/08	MAYARA	SC BRAGANÇA PAULISTA	ANDREIA
31/08 à 04/09	MAYARA	SC BRAGANÇA PAULISTA	ANDREIA
07/09 à 11/09	MAYARA	SC BRAGANÇA PAULISTA	ANDREIA
14/09 à 18/09	MAYARA	SC BRAGANÇA PAULISTA	ANDREIA
21/09 à 25/09	MAYARA	VAGO	
28/09 à 02/10	MAYARA	VAGO	
05/10 à 09/10	MAYARA	VAGO	
12/10 à 16/10	MAYARA	VAGO	
19/10 à 23/10	MAYARA	VAGO	
26/10 à 30/10	MAYARA	VAGO	
02/11 à 06/11	MAYARA	VAGO	
09/11 à 13/11	MAYARA	VAGO	
16/11 à 20/11	MAYARA	VAGO	
23/11 à 27/11	MAYARA	VAGO	
30/11 à 04/12	MAYARA	VAGO	
07/12 à 11/12	MAYARA	VAGO	
14/12 à 18/12	MAYARA	VAGO	
21/12 à 25/12	MAYARA	VAGO	
05/01 à 09/01	MIGUEL	JJM - GUARULHOS	JESUS
12/01 à 16/01	MIGUEL	JJM - GUARULHOS	JESUS
19/01 à 23/01	MIGUEL	JJM - GUARULHOS	JESUS
26/01 à 30/01	MIGUEL	JJM - GUARULHOS	JESUS
02/02 à 06/02	MIGUEL		JESUS
09/02 à 13/02	MIGUEL		JESUS
16/02 à 20/02	MIGUEL		JESUS
23/02 à 27/02	MIGUEL		JESUS
02/03 à 06/03	MIGUEL		JESUS
09/03 à 13/03	MIGUEL		JESUS
16/03 à 20/03	MIGUEL		JESUS
23/03 à 27/03	MIGUEL		JESUS
30/03 à 03/04	MIGUEL	JJM - GUARULHOS	JESUS
06/04 à 10/04	MIGUEL	JJM - GUARULHOS	JESUS
13/04 à 17/04	MIGUEL	JJM - GUARULHOS	JESUS
20/04 à 24/04	MIGUEL	JJM - GUARULHOS	JESUS
27/04 à 01/05	MIGUEL	JJM - GUARULHOS	JESUS
04/05 à 08/05	MIGUEL	JJM - GUARULHOS	JESUS
11/05 à 15/05	MIGUEL	JJM - GUARULHOS	JESUS
18/05 à 22/05	MIGUEL	JJM - GUARULHOS	JESUS
25/05 à 29/05	MIGUEL	JJM - GUARULHOS	JESUS
01/06 à 05/06	MIGUEL	VAGO	
08/06 à 12/06	MIGUEL	VAGO	
15/06 à 19/06	MIGUEL	VAGO	
22/06 à 26/06	MIGUEL	VAGO	
29/06 à 03/07	MIGUEL	VAGO	
06/07 à 10/07	MIGUEL	VAGO	
13/07 à 17/07	MIGUEL	VAGO	
20/07 à 24/07	MIGUEL	VAGO	
27/07 à 31/07	MIGUEL	VAGO	
03/08 à 07/08	MIGUEL	VAGO	
10/08 à 14/08	MIGUEL	VAGO	
17/08 à 21/08	MIGUEL	VAGO	
24/08 à 28/08	MIGUEL	VAGO	
31/08 à 04/09	MIGUEL	VAGO	
07/09 à 11/09	MIGUEL	VAGO	
14/09 à 18/09	MIGUEL	VAGO	
21/09 à 25/09	MIGUEL	VAGO	
28/09 à 02/10	MIGUEL	VAGO	
05/10 à 09/10	MIGUEL	VAGO	
12/10 à 16/10	MIGUEL	VAGO	
19/10 à 23/10	MIGUEL	VAGO	
26/10 à 30/10	MIGUEL	VAGO	
02/11 à 06/11	MIGUEL	VAGO	
09/11 à 13/11	MIGUEL	VAGO	
16/11 à 20/11	MIGUEL	VAGO	
23/11 à 27/11	MIGUEL	VAGO	
30/11 à 04/12	MIGUEL	VAGO	
07/12 à 11/12	MIGUEL	VAGO	
14/12 à 18/12	MIGUEL	VAGO	
21/12 à 25/12	MIGUEL	VAGO"""

# Colors for new projects (cycling)
COLORS = [
    'bg-indigo-100 text-indigo-700 border-indigo-200',
    'bg-purple-100 text-purple-700 border-purple-200',
    'bg-cyan-100 text-cyan-700 border-cyan-200',
    'bg-orange-100 text-orange-700 border-orange-200',
    'bg-teal-100 text-teal-700 border-teal-200',
    'bg-pink-100 text-pink-700 border-pink-200',
    'bg-lime-100 text-lime-700 border-lime-200',
    'bg-amber-100 text-amber-700 border-amber-200'
]

lines = data.split('\n')
parsed_allocations = []
projects = set()

# Parse Data
for line in lines:
    if not line.strip():
        continue
    parts = line.split('\t')
    if len(parts) >= 2:
        period = parts[0]
        consultant = parts[1].strip()
        project = parts[2].strip() if len(parts) > 2 else 'VAGO'
        
        if project == 'VAGO' or project == '':
            continue
            
        # Parse period (05/01 à 09/01)
        try:
            date_range = period.split(' à ')
            start_str = date_range[0] + '/2026'
            start_date = datetime.datetime.strptime(start_str, '%d/%m/%Y').strftime('%Y-%m-%d')
            
            projects.add(project)
            parsed_allocations.append({
                'consultant': consultant,
                'project': project,
                'start_date': start_date,
                'days': 5 # Default duration
            })
        except Exception as e:
            # print(f"Skipping line due to error: {line} - {e}")
            pass

# Generate SQL
sql = """-- Seed Data for 2026 Schedule
TRUNCATE TABLE allocations CASCADE;

-- Insert Projects (if not exists)
"""

for i, proj in enumerate(sorted(projects)):
    color = COLORS[i % len(COLORS)]
    # Use single quotes for SQL, escape existing single quotes
    proj_sql = proj.replace("'", "''")
    sql += f"INSERT INTO projects (id, name, color) SELECT gen_random_uuid(), '{proj_sql}', '{color}' WHERE NOT EXISTS (SELECT 1 FROM projects WHERE name = '{proj_sql}');\n"

sql += """
-- Insert Allocations
DO $$
DECLARE
    consultant_id uuid;
    project_id uuid;
BEGIN
"""

for alloc in parsed_allocations:
    consultant = alloc['consultant']
    project = alloc['project'].replace("'", "''")
    start_date = alloc['start_date']
    
    # Consultant matching logic
    consultant_clause = ""
    if consultant == 'LUCAS':
        consultant_clause = "full_name ILIKE '%LUCAS%'"
    elif consultant == 'ANDRÉ':
        consultant_clause = "full_name ILIKE '%ANDRE%'"
    else:
        consultant_clause = f"full_name ILIKE '%{consultant}%'"
        
    sql += f"""
    SELECT id INTO consultant_id FROM profiles WHERE {consultant_clause} LIMIT 1;
    SELECT id INTO project_id FROM projects WHERE name = '{project}';
    
    IF consultant_id IS NOT NULL AND project_id IS NOT NULL THEN
        INSERT INTO allocations (consultant_id, project_id, start_date, days)
        VALUES (consultant_id, project_id, '{start_date}', 5);
    END IF;
    """

sql += """
END $$;
"""

with open('seed_schedule.sql', 'w', encoding='utf-8') as f:
    f.write(sql)
    
print("Regenerated seed_schedule.sql successfully.")
